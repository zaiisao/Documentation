
---
title: Signaling API
description: 
platform: iOS
updatedAt: Wed Jul 31 2019 12:34:18 GMT+0800 (CST)
---
# Signaling API
> Version: v1.4.4

## Methods

> Only the built-in attributes come after an underscore; the custom attributes do not.

### Lifecycle

#### Retrieves an AgoraAPI Instance (getInstanceWithoutMedia:)

This method retrieves an <code>AgoraAPI</code> instance.

```
+ (AgoraAPI*) getInstanceWithoutMedia:(NSString*)appId;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>appId</code></td>
<td>The App ID provided by Agora. For more information, see <a href="../../en/Agora%20Platform/key_signaling.md">Get an App ID</a>.</td>
</tr>
</tbody>
</table>

#### Creates multiple AgoraAPI instances (createSigInstance:)

To create multiple <code>AgoraAPI</code> instances, call this method as many times.

Return: An AgoraAPI instance.

```
+ (AgoraAPI*) createSigInstance: (NSString*)appId
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>appId</code></td>
<td>The App ID provided by Agora. For more information, see <a href="../../en/Agora%20Platform/key_signaling.md">Get an App ID</a>.</td>
</tr>
</tbody>
</table>



#### Destroys the AgoraAPIOnlySignal Instance (destroy)

This method destroys the <code>AgoraAPIOnlySignal</code> instance.

```
- (void) destroy;
```

### Login

#### Log into Agora's Signaling System (login:account:token:uid:deviceID:)

Use this method to log into Agora’s signaling system. Users must always log in before performing any operation.

```
- (void) login:(NSString*)appId account:(NSString*)account token:(NSString*)token uid:(uint32_t)uid deviceID:(NSString*)deviceID ;
```

- When login is successful, the <code>onLoginSuccess</code> callback function is triggered.
- When login fails, the <code>onLoginFailed</code> callback function is triggered.
- When the SDK loses connection with the server, the <code>onLogout</code> callback function is triggered.

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>appId</code></td>
<td>The App ID provided by Agora. For more information, see <a href="../../en/Agora%20Platform/key_signaling.md">Get an App ID</a>.</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID defined by the client. It can be up to 128 visible characters (space is not allowed). It can be a uid, nickname, guid, and other content that must be unique. The account parameters in this document follow this rule.</td>
</tr>
<tr><td><code>token</code></td>
<td><code>SignalingToken</code> generated by the App ID and App Certificate. See <a href="../../en/Agora%20Platform/key_signaling.md">How to Get and Use a SignalingToken</a> for details.</td>
</tr>
<tr><td><code>uid</code></td>
<td>N/A: Set it as 0</td>
</tr>
<tr><td><code>deviceID</code></td>
<td>Set it as NULL.</td>
</tr>
</tbody>
</table>



> You can skip generating the token in a test environment by setting `token` to `_no_need_token`. However, Agora does not recommend this in a production environment. By default, if you are already logged in, the call of `login` will be ignored. To cancel the previous login, call `logout` beforehand without having to wait until it is successfully executed.

#### Log into Agora's Signaling System (login2:account:token:uid:deviceID:retry_time_in_s:retry_count:)

Use this method to log into Agora’s signaling system. Users must always log in before performing any operations.

```
- (void) login2:(NSString*)appId account:(NSString*)account token:(NSString*)token uid:(uint32_t)uid deviceID:(NSString*)deviceID retry_time_in_s:(int)retry_time_in_s retry_count:(int)retry_count;
```

- When Login is successful, the <code>onLoginSuccess</code> callback function is triggered.
- When login fails, the <code>onLoginFailed</code> callback function is triggered.
- When loses connection with server, the <code>onLogout</code> callback function is triggered.

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>appId</code></td>
<td>The App ID provided by Agora. For more information, see <a href="../../en/Agora%20Platform/key_signaling.md">Get an App ID</a>.</td>
</tr>
<tr><td><code>account</code></td>
<td>The user ID defined by the client. It can be up to 128 visible characters (space is not allowed). It can be uid, nickname, guid and other content, so long as it is unique. The account parameters in this document follow this rule.</td>
</tr>
<tr><td><code>token</code></td>
<td>The <code>SignalingToken</code> generated by App ID and App Certificate. See <a href="../../en/Agora%20Platform/key_signaling.md">How to Get and Use a SignalingToken</a> for details.</td>
</tr>
<tr><td><code>uid</code></td>
<td>Obsolete: set it to 0</td>
</tr>
<tr><td><code>deviceID</code></td>
<td>Set it to NULL.</td>
</tr>
<tr><td><code>retry_time_in_s</code></td>
<td>The maximum time allowed to re-login, 30 seconds by default.</td>
</tr>
<tr><td><code>retry_count</code></td>
<td>The maximum times allowed to re-login, 3 times by default.</td>
</tr>
</tbody>
</table>



> You can skip generating the token in a test environment by setting `token` to `_no_need_token`. However, Agora does not recommend this in a production environment. `onLoginFailed` will be triggered and reconnection stopped when either `retry_time_in_s` or `retry_count` is reached.

#### Log out of Agora's Signaling System (logout)

This method triggers the <code>onLogout</code> callback function when called successfully.

```
- (void) logout;
```

#### Remote Calling Process (invoke:req:callID:)

This method is used for the remote calling process and triggers the <code>onInvokeRet</code> callback function when called successfully.

```
- (void) invoke:(NSString*)name req:(NSString*)req callID:(NSString*)callID ;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Function</th>
<th>Parameter Settings and Returns</th>
</tr>
<tr><td>Queries the user status.</td>
<td><ul>
<li>name: io.agora.signal.user_query_user_status</li>
<li>req: {“account”:account of the user}</li>
<li>Returns: status(1:online; 0:offline)</li>
</ul>
</td>
</tr>
<tr><td>Sets a user attribute.</td>
<td><ul>
<li>name: io.agora.signal.user_set_attr</li>
<li>req: {“name”:attribute name,”value”:attribute value}</li>
</ul>
</td>
</tr>
<tr><td>Retrieves a user attribute.</td>
<td><ul>
<li>name: io.agora.signal.user_get_attr</li>
<li>req: {“account”:account of the user,”name”:attribute name}</li>
<li>Returns: {“value”:attribute value}</li>
</ul>
</td>
</tr>
<tr><td>Retrieves all attributes of a user.</td>
<td><ul>
<li>name: io.agora.signal.user_get_attr_all</li>
<li>req: {“account”:account of the user}</li>
<li>Returns: The JSON value of all attributes</li>
</ul>
</td>
</tr>
<tr><td>Retrieves the number of the users in a channel.</td>
<td><ul>
<li>name: io.agora.signal.channel_query_num</li>
<li>req: {“name”:channel name}</li>
<li>Returns: All users in the channel</li>
</ul>
</td>
</tr>
<tr><td>Checks if a user is in a specific channel.</td>
<td><ul>
<li>name: io.agora.signal.channel_query_user_isin</li>
<li>req: {“name”:channel name,”account”:account of the user}</li>
<li>Returns: isin（1: in the channel; 0:not in the channel）</li>
</ul>
</td>
</tr>
<tr><td>Retrieves a list of the users in a channel.</td>
<td><ul>
<li>name: io.agora.signal.channel_query_userlist</li>
<li>req: {“name”:channel name}</li>
<li>Returns: {“num”:number of the users in the channel,”list”:the latest user}</li>
</ul>
</td>
</tr>
<tr><td>Retrieves a list of the latest users in a channel.<b>Deprecated</b> </td>
<td><ul>
<li>name: io.agora.signal.channel_query_userlist_all</li>
<li>req: {“name”:channel name,”num”:number (by default 1000*1000)}</li>
<li>Returns: {“num”:number of the users in the channel,”list”:the latest users}</li>
<li>Agora recommends using it on the server. If using it on the client, pay attention to the limit on the usage frequency.</li>
</ul>
</td>
</tr>
<tr><td>Clears all attributes of a specific channel.</td>
<td><ul>
<li>name: io.agora.signal.channel_clear_attr</li>
<li>req: {“channel”:channel name}</li>
</ul>
</td>
</tr>
<tr><td>Deletes an attribute of a specific channel.</td>
<td><ul>
<li>name: io.agora.signal.channel_del_attr</li>
<li>req: {“channel”:channel name,”name”:attribute name}</li>
</ul>
</td>
</tr>
<tr><td>Sets an attribute of a specific channel.</td>
<td><ul>
<li>name: io.agora.signal.channel_set_attr</li>
<li>req: {“channel”:channel name,”name”:attribute name,”value”:value name}</li>
</ul>
</td>
</tr>
</tbody>
</table>



#### Queries the User Status (queryUserStatus:)

This method checks whether a user is online and triggers the <code>onQueryUserStatusResult</code> callback function.

```
- (void) queryUserStatus:(NSString*)account ;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>account</code></td>
<td>Account of the user</td>
</tr>
</tbody>
</table>



#### Sets a User Attribute (setAttr:value:)

This method sets a user attributes.

```
- (void) setAttr:(NSString*)name value:(NSString*)value;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>name</code></td>
<td>Attribute name, can be up to 128 visible characters. </td>
</tr>
<tr><td><code>value</code></td>
<td>Attribute value, can be up to 1024 visible characters.</td>
</tr>
</tbody>
</table>



#### Retrieves Your Specified Attribute (getAttr)

This method retrieves your specified attribute and triggers the <code>onUserAttrResult</code> callback function when called successfully.

```
- (void) getAttr:(NSString*)name;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>name</code></td>
<td><p>Attribute name.</p>
<p>It can be up to 128 visible characters</p>
</td>
</tr>

</tbody>
</table>



#### Retrieves all of Your Attributes (getAttrAll)

This method retrieves all of your attributes. You will receive the <code>onUserAttrAllResult</code> callback function when this method is called successfully.

```
- (void) getAttrAll;
```

#### Retrieves the Attributes of a Specified User (getUserAttr:name:)

This method allows the user to retrieve the attributes of a specified user. The user will receive the <code>onUserAttrResult</code> callback function.

```
- (void) getUserAttr:(NSString*)account name:(NSString*)name;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>account</code></td>
<td>User ID defined by the client.</td>
</tr>
<tr><td><code>name</code></td>
<td><p>Attribute name.</p>
<p>It can be up to 128 visible characters</p>
</td>
</tr>

</tbody>
</table>



#### Retrieves all Attributes of a Specified User (getUserAttrAll:)

This method allows the user to get all attributes of a specified user. The user will receive the <code>onUserAttrAllResult</code> callback function when this method is called successfully.

```
- (void) getUserAttrAll:(NSString*)account;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>account</code></td>
<td>User ID defined by the client.</td>
</tr>
</tbody>
</table>



#### Sends a Point-to-point Message (messageInstantSend:uid:msg:msgID:)

This method sends a point-to-point message to a specified user.

When this method is called successfully, the sender receives the <code>onMessageSendSuccess</code> callback function, while the receiver receives the <code>onMessageInstantReceive</code> callback function.

If this method fails, the sender receives the <code>onMessageSendError</code> callback function.

```
- (void) messageInstantSend:(NSString*)account uid:(uint32_t)uid msg:(NSString*)msg msgID:(NSString*)msgID;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>account</code></td>
<td>User ID defined by the client.</td>
</tr>
<tr><td><code>uid</code></td>
<td>N/A: Set as 0.</td>
</tr>
<tr><td><code>msg</code></td>
<td>Message body. Each message must not exceed 8 KB visible characters.</td>
</tr>
<tr><td><code>msgID</code></td>
<td>Message ID. Agora recommends setting it to “”, allowing the SDK to generate and assign the msgID and to ensure its uniqueness.</td>
</tr>
</tbody>
</table>



### Channel

#### Allows a User to Join a Channel (channelJoin:)

This method allows a user to join a specified channel. When a user joins a specified channel, the user will be disconnected from any previously joined channel.

Once a user joins a channel, the user receives the <code>onChannelJoined</code> callback function, and the other users in the same channel receive the <code>onChannelUserJoined</code> callback function. If a user fails to join a specified channel, the user receives the <code>onChannelJoinFailed</code> callback function.

```
- (void) channelJoin:(NSString*)channelID;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td><p>Channel name. It can be up to 128 visible characters and include the following special channel names and attributes <b>Deprecated and NOT recommended</b>:</p>
<ul>
<li><code>_agora_user_online</code>: All user-online or user-offline events within the current <code>appID</code> will be sent to this channel.</li>
<li><code>_agora_channel_event</code>: All events about a user joining or leaving a channel within the current <code>appID</code> will be sent to this channel.</li>
</ul>
</td>
</tr>
</tbody>
</table>



> Special channels are used by servers only to receive login and channel events.

#### Allows a User to Leave a Channel (channelleave:)

This method allows a user to leave the current channel. Once a user has left the channel, the other users in the channel will receive the <code>onChannelUserLeaved</code> callback function.

```
- (void) channelLeave:(NSString*)channelID;
```

<table>
<colgroup>
<col/>
<col/>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td><p>Channel name.</p>
<p>It can be up to 128 visible characters.</p>
</td>
</tr>

</tbody>
</table>



#### Queries the Number of Users in a Channel (channelQueryUserNum:)

This method allows a user to query the number of users in a specified channel. The user will receive the <code>onChannelQueryUserNumResult</code> callback function when this method is called successfully.

```
- (void) channelQueryUserNum:(NSString*)channelID;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td><p>Channel name.</p>
<p>It can be up to 128 visible characters.</p>
</td>
</tr>
</tbody>
</table>



#### Queries if a User is in a Channel (channelQueryUserIsIn:account:)

This method queries if a specified user is in a specified channel and triggers the <code>onChannelQueryUserIsIn</code> callback function when this method is called successfully.

```
- (void) channelQueryUserIsIn:(NSString*)channelID account:(NSString*)account ;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name. Maximum length is 128 visible characters.</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID defined by the client.</td>
</tr>
</tbody>
</table>



#### Sets the Channel Attributes (channelSetAttr:name:value:)

This method sets the channel attributes. Whenever a change is made to the attributes, all users in the channel will receive the <code>onChannelAttrUpdated</code> callback function.

```
- (void) channelSetAttr:(NSString*)channelID name:(NSString*)name value:(NSString*)value;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td><p>Channel name.</p>
<p>It can be up to 128 visible characters.</p>
</td>
</tr>
<tr><td><code>name</code></td>
<td><p>Attribute name.</p>
<p>It can be up to 128 visible characters.</p>
</td>
</tr>
<tr><td><code>value</code></td>
<td><p>Attribute value.</p>
<p>It can be up to 8096 visible characters.</p>
</td>
</tr>
</tbody>
</table>



The following table shows the built-in attributes of the parameter, <code>name</code>:

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Attributes</th>
<th>Description</th>
</tr>
<tr><td><code>_userNotification </code><b>Deprecated</b></td>
<td><ul>
<li>1: (Default) The channel sends the callback function that a user has joined or left the channel.</li>
<li>0: The channel does not send the callback function that a user has joined or left the channel.</li>
</ul>
</td>
</tr>
<tr><td><code>_channel_ttl</code></td>
<td>Time (s) between the last user leaving a channel and the system destroying the channel. The default value is 7200. A special channel will never be destroyed.</td>
</tr>
<tr><td><code>_member_num</code></td>
<td>Number of the users currently in the channel. It is automatically updated by the system.</td>
</tr>
<tr><td><code>_auto_update_num</code></td>
<td><p>Indicates whether to automatically refresh the number of the users currently in the channel.</p>
<ul>
<li>0: (Default) Disabled</li>
<li>1~n: Refreshing frequency (s)</li>
</ul>
</td>
</tr>
<tr><td><code>_total_member_num</code><b>Deprecated</b></td>
<td>Automatically indicates the accumulated number of the users in the channel. Similar to <code>_member_num</code> , <code>_auto_update_num</code> and <code>_auto_update_total_num</code> both need to be set to none zero.</td>
</tr>
<tr><td><code>_auto_update_total_num</code><b>Deprecated</b> </td>
<td><p>Indicates whether to automatically refresh the number of the users currently in the channel.</p>
<ul>
<li>0: (Default) Disabled</li>
<li>1 - n: Refreshing frequency (s) (same as <code>_auto_update_num</code> )</li>
</ul>
</td>
</tr>
</tr>
<tr><td><code>_sendmsg_limit</code></td>
<td>Maximum messages allowed to be sent in the channel.</td>
</tr>
</tr>
<tr><td><code>_setattr_limit</code></td>
<td>Maximum times for updating a channel attribute in a second.</td>
</tr>
</tbody>
</table>



#### Deletes the Channel Attributes (channelDelAttr:name:)

This method deletes the channel attributes. All users in the channel will receive the <code>onChannelAttrUpdated</code> callback function, when the method is called successfully.

```
- (void) channelDelAttr:(NSString*)channelID name:(NSString*)name;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td><p>Channel name.</p>
<p>It can be up to 128 visible characters.</p>
</td>
</tr>
<tr><td><code>name</code></td>
<td><p>Attribute name.</p>
<p>It can be up to 128 visible characters.</p>
</td>
</tr>
</tbody>
</table>



#### Deletes all Channel Attributes (channelClearAttr:)

This method deletes all attributes of a specified channel.

```
- (void) channelClearAttr:(NSString*)channelID;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td><p>Channel name.</p>
<p>It can be up to 128 visible characters.</p>
</td>
</tr>
</tbody>
</table>



#### Sends a Channel Message (messageChannelSend:msg:msgID:)

This method sends a channel message, and all users in the same channel receive the <code>onMessageChannelReceive</code> callback function.

The user who sent the message receives the <code>onMessageSendSuccess</code> callback function upon a successful execution; otherwise, receives the <code>onMessageSendError</code> callback function.

```
- (void) messageChannelSend:(NSString*)channelID msg:(NSString*)msg msgID:(NSString*)msgID;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name. It can be up to 128 visible characters.</td>
</tr>
<tr><td><code>msg</code></td>
<td>Message body. Each channel message must not exceed 8 KB visible characters. Each user cannot send more than 60 messages per second, and the entire channel cannot send more than 200 messages per second.</td>
</tr>
<tr><td><code>msgID</code></td>
<td>Visible characters. Message ID. Agora recommends setting it to “”, allowing the SDK to generate and assign the msgID and to ensure its uniqueness.</td>
</tr>
</tbody>
</table>



### Calling

#### Initiates a Call (channelInviteUser:account:uid:)

> Calling and joining a channel are two separate processes. The user has to call <code>channelJoin</code> to join the channel. The user can either join the channel before sending a call invitation or send a call invitation before joining the channel (when the counterpart accepts the invitation).

This method initiates a call, that is, invites a user to join a specified channel. If the call fails, the user will receive the <code>onInviteFailed</code> callback function. Possible reasons include:

- The other user is offline.
- Local network issues.
- Server errors.

If the caller gets a confirmation from the callee, the caller will receive the <code>onInviteReceivedByPeer</code> callback function, and the callee will receive the <code>onInviteReceived</code> callback function.

```
- (void) channelInviteUser:(NSString*)channelID account:(NSString*)account uid:(uint32_t)uid ;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td><p>Channel name.</p>
<p>It can be up to 128 visible characters.</p>
</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the other user defined by the client.</td>
</tr>
<tr><td><code>uid</code></td>
<td>N/A. Set as 0.</td>
</tr>
</tbody>
</table>



#### Initiates a Call (channelInviteUser2:account:extra:)

Same as <code>channelInviteUser:account:uid:</code> except for the parameters.

```
- (void) channelInviteUser2:(NSString*)channelID account:(NSString*)account extra:(NSString*)extra ;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name: It can be up to 128 visible characters.</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the other user defined by the client.</td>
</tr>
<tr><td><code>extra</code></td>
<td><p>Extra information that the caller wants to send to the callee. It can be up to 8 KB visible characters and must be in JSON format. For example:</p>
<div><ul>
<li>{“_require_peer_online”:1}  If the counterpart is offline, the <code>onInviteFailed</code> callback function will be triggered immediately.</li>
<li>{“_require_peer_online”:0}  If the counterpart is offline for more than 20 seconds, the <code>onInviteFailed</code> callback will be triggered (default).</li>
<li>{“destMediaUid” : 123}  Specify the <code>uid</code> for joining the corresponding media channel.</li>
<li>{“srcNum” : “+123456789”} Specify the phone number to be displayed on the screen of the remote phone.</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>



> You do not need to set the `_require_peer_online` field when making a SIP call.

#### Sends a DTMF (Dual-tone Multi-frequency) Message to the Other User (channelInviteDTMF:phoneNum:dtmf:)

This method sends a DTMF message to the other user by calling through the SIP gateway. The receiver will receive the <code>onInviteMsg</code> callback function.

```
- (void) channelInviteDTMF:(NSString*)channelID phoneNum:(NSString*)phoneNum dtmf:(NSString*)dtmf;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td><p>Channel name.</p>
<p>It can be up to 128 visible characters.</p>
</td>
</tr>
<tr><td><code>phoneNum</code></td>
<td>Phone number of the other user.</td>
</tr>
<tr><td><code>dtmf</code></td>
<td>Subsequent analog phone number (DTMF) to be entered after the call gets through.</td>
</tr>
</tbody>
</table>



#### Accepts a Call (channelInviteAccept:account:uid:extra:)

This method accepts a call request or invitation. Once this API is called, the other user will receive the <code>onInviteAcceptedByPeer</code> callback function.

```
- (void) channelInviteAccept:(NSString*)channelID account:(NSString*)account uid:(uint32_t)uid extra:(NSString*)extra ;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td><p>Channel name.</p>
<p>It can be up to 128 visible characters.</p>
</td>
</tr>
<tr><td><code>account</code></td>
<td>The caller’s user ID.</td>
</tr>
<tr><td><code>uid</code></td>
<td><p>N/A.</p>
<p>Set as 0.</p>
</td>
</tr>
<tr><td><code>extra</code></td>
<td><p>In JSON format. Can be “”.</p>
<p>User-defined information.</p>
<p>Can be used for a SIP call.</p>
</td>
</tr>
</tbody>
</table>



#### Rejects a Call (channelInviteRefuse:account:uid:extra:)

This method rejects the received call invitation or request. Once this API is called, the other user will receive the <code>onInviteRefusedByPeer</code> callback function.

```
- (void) channelInviteRefuse:(NSString*)channelID account:(NSString*)account uid:(uint32_t)uid extra:(NSString*)extra ;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td><p>Channel name.</p>
<p>It can be up to 128 visible characters.</p>
</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the other user defined by the client.</td>
</tr>
<tr><td><code>uid</code></td>
<td><p>N/A.</p>
<p>Set as 0.</p>
</td>
</tr>
<tr><td><code>extra</code></td>
<td><p>Extra information to send to the user being called.</p>
<p>For example, this is a video call or voice call.</p>
<p>It must be in JSON format.</p>
</td>
</tr>
</tbody>
</table>



#### Ends a Call (channelInviteEnd:account:uid:)

This method ends a call after the call has been connected. The user receives the <code>onInviteEndByMyself</code> callback function, and the other user receives the <code>onInviteEndByPeer</code> callback function.

```
- (void) channelInviteEnd:(NSString*)channelID account:(NSString*)account uid:(uint32_t)uid;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td><p>Channel name.</p>
<p>It can be up to 128 visible characters.</p>
</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the other user defined by the client.</td>
</tr>
<tr><td><code>uid</code></td>
<td><p>N/A.</p>
<p>Set as 0.</p>
</td>
</tr>
</tbody>
</table>



### Miscellaneous

#### Retrieves the User Status (getStatus)

This method retrieves the user status.

```
- (int) getStatus;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Return Value</th>
<th>Description</th>
</tr>
<tr><td>LOGIN_STATE_NOT_LOGIN</td>
<td>0: The user has not logged in.</td>
</tr>
<tr><td>LOGIN_STATE_LOGINING</td>
<td>1: The user is logging in.</td>
</tr>
<tr><td>LOGIN_STATE_LOGINED</td>
<td>2: The user has logged in.</td>
</tr>
<tr><td>LOGIN_STATE_RECONNECTING</td>
<td>3: The user is reconnecting.</td>
</tr>
</tbody>
</table>



#### Retrieves the SDK Version (getSdkVersion)

This method retrieves the version of the SDK.

```
- (int) getSdkVersion;
```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Return Value</th>
<th>Description</th>
</tr>
<tr><td>The SDK version.</td>
<td>For example, 1010104019 means version 1.1.4.19.</td>
</tr>
</tbody>
</table>



#### Sends a Channel Message (messageChannelSendForce:msg:msgID:)

This method sends a channel message without joining a channel. Agora does not recommend using this method at the application level.

```
- (void) messageChannelSendForce:(NSString*)channelID msg:(NSString*)msg msgID:(NSString*)msgID ;

```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>The channel ID.</td>
</tr>
<tr><td><code>msg</code></td>
<td>The message to send.</td>
</tr>
<tr><td><code>msgID</code></td>
<td>Message ID. Agora recommends setting it to “”, allowing the SDK to generate and assign the msgID and to ensure its uniqueness.</td>
</tr>
</tbody>
</table>



### Obsolete Interfaces

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Interfaces</th>
<th>Prototype</th>
</tr>
<tr><td><code>messageDTMFSend</code></td>
<td>(void) messageDTMFSend:(uint32_t)uid msg:(NSString*)msg msgID:(NSString*)msgID;</td>
</tr>
<tr><td><code>channelInvitePhone</code></td>
<td>(void) channelInvitePhone:(NSString*)channelID phoneNum:(NSString*)phoneNum uid:(uint32_t)uid;</td>
</tr>
<tr><td><code>channelInvitePhone2</code></td>
<td>(void) channelInvitePhone2:(NSString*)channelID phoneNum:(NSString*)phoneNum sourcesNum:(NSString*)sourcesNum;</td>
</tr>
<tr><td><code>channelInvitePhone3</code></td>
<td>(void) channelInvitePhone3:(NSString*)channelID phoneNum:(NSString*)phoneNum sourcesNum:(NSString*)sourcesNum extra:(NSString*)extra;</td>
</tr>
<tr><td><code>isOnline</code></td>
<td>(bool) isOnline;</td>
</tr>
</tbody>
</table>



## Callback Functions

The following callback functions are related to Agora’s signaling system.

> Avoid using synchronous or block callback operations. Otherwise, the signaling system may crash.

### The Connection with the Agora’s Signaling System has been Lost  (onReconnecting)

This callback function is triggered when the connection with Agora’s signaling system has been lost after login.

```
@property (copy) void(^onReconnecting)(uint32_t nretry) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>nretry</code></td>
<td>The current reconnection number.</td>
</tr>
</tbody>
</table>



### An Error has Occurred During SDK Runtime (onError:name:ecode:desc)

This callback function returns a detailed description of the error.

```
@property (copy) void(^onError)(NSString* name,AgoraEcode ecode,NSString* desc) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>name</code></td>
<td>Error type.</td>
</tr>
<tr><td><code>ecode</code></td>
<td><p>Error code. For more information, see <a href="../../en/Signaling/the_error_signaling.html.md">Error Codes and Warning Codes</a>.</p>
<ul>
<li>AgoraEcode_GENERAL_E = 1000: Unknown error</li>
<li>AgoraEcode_GENERAL_E_FAILED = 1001: Operation failed.</li>
<li>AgoraEcode_GENERAL_E_UNKNOWN = 1002: Unknown error</li>
<li>AgoraEcode_GENERAL_E_NOT_LOGIN = 1003: Not logged in.</li>
<li>AgoraEcode_GENERAL_E_WRONG_PARAM = 1004: Wrong parameter.</li>
<li>AgoraEcode_GENERAL_E_LARGE_PARAM = 1005: Large parameter.</li>
</ul>
</td>
</tr>
<tr><td><code>desc</code></td>
<td>Description of the error.</td>
</tr>
</tbody>
</table>



### The User Status (onQueryUserStatusResult:name:status)

This callback function returns the query result of the user status and is triggered when <code>queryUserStatus</code> is called.

```
@property (copy) void(^onQueryUserStatusResult)(NSString* name,NSString* status) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>name</code></td>
<td>Account of the user.</td>
</tr>
<tr><td><code>status</code></td>
<td><p>Status of the user: Whether the user is online.</p>
<ul>
<li>1: User is online.</li>
<li>0: User is offline.</li>
</ul>
</td>
</tr>
</tbody>
</table>



### The Application has Reconnected to the Agora’s Signaling System (onReconnected)

This callback function is triggered when the application is reconnected to Agora’s signaling system. When the reconnection fails, the <code>onLogout</code> callback function will be triggered instead.

```
@property (copy) void(^onReconnected)(int fd) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>fd</code></td>
<td>Agora internal use only.</td>
</tr>
</tbody>
</table>



### A User has Logged into the Agora’s Signaling System (onLoginSuccess)

This callback function is triggered when a user has logged into Agora’s signaling system.

```
@property (copy) void(^onLoginSuccess)(uint32_t uid,int fd) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>fd</code></td>
<td>Agora internal use only.</td>
</tr>
</tbody>
</table>



### A User has Logged out of Agora’s Signaling System (onLogout)

This callback function is triggered when a user has logged out of Agora’s signaling system.

```
@property (copy) void(^onLogout)(AgoraEcode ecode) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>ecode</code></td>
<td>Error code</td>
</tr>
</tbody>
</table>



### The Remote Calling Process has Succeeded (onInvokeRet)

This callback function is triggered when the remote calling process has succeeded.

```
@property (copy) void(^onInvokeRet)(NSString* callID,NSString* err,NSString* resp) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>callID</code></td>
<td>Call ID introduced by <code>invoke</code>.</td>
</tr>
<tr><td><code>err</code></td>
<td>Error code.</td>
</tr>
<tr><td><code>resp</code></td>
<td>Returned JSON value.</td>
</tr>
</tbody>
</table>



### A User has Failed to Log into Agora’s Signaling System (onLoginFailed)

This callback function is triggered when a user has failed to log into Agora’s signaling system.

```
@property (copy) void(^onLoginFailed)(AgoraEcode ecode) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>ecode</code></td>
<td>Error code</td>
</tr>
</tbody>
</table>



### A User has Joined a Channel  (onChannelJoined)

This callback function is triggered when a user has joined a channel.

```
@property (copy) void(^onChannelJoined)(NSString* channelID) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name</td>
</tr>
</tbody>
</table>



### A User has Failed to Join a Channel (onChannelJoinFailed)

This callback function is triggered when a user has failed to join a channel.

```
@property (copy) void(^onChannelJoinFailed)(NSString* channelID,AgoraEcode ecode) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name</td>
</tr>
<tr><td><code>ecode</code></td>
<td>Error code</td>
</tr>
</tbody>
</table>



### A User has Left a Channel (onChannelLeaved)

This callback function is triggered when a user has left a channel.

```
@property (copy) void(^onChannelLeaved)(NSString* channelID,AgoraEcode ecode) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name</td>
</tr>
<tr><td><code>ecode</code></td>
<td>Error code</td>
</tr>
</tbody>
</table>



### Another User has Joined the Channel  (onChannelUserJoined)

This callback function is triggered when another user has joined the channel.

```
@property (copy) void(^onChannelUserJoined)(NSString* account,uint32_t uid) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the other user defined by the client.</td>
</tr>
<tr><td><code>uid</code></td>
<td>N/A.</td>
</tr>
</tbody>
</table>



### Another User has Left the Channel (onChannelUserLeaved)

This callback function is triggered when another user has left the channel.

```
@property (copy) void(^onChannelUserLeaved)(NSString* account,uint32_t uid) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the other user defined by the client.</td>
</tr>
<tr><td><code>uid</code></td>
<td>N/A.</td>
</tr>
</tbody>
</table>



### The User List in the Channel (onChannelUserList)

A user will receive this callback function after joining a channel.

> The retrieved user list includes a maximum of the latest 200 users in the channel.

<br/>

```
@property (copy) void(^onChannelUserList)(NSMutableArray* accounts, NSMutableArray* uids);


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>accounts</code></td>
<td>List of User IDs defined by the client.</td>
</tr>
<tr><td><code>uids</code></td>
<td>List of users in the channel.</td>
</tr>
</tbody>
</table>



### The Number of Users in a Channel (onChannelQueryUserNumResult)

This callback function is triggered when a user has queried the number of users in a channel.

```
@property (copy) void(^onChannelQueryUserNumResult)(NSString* channelID,AgoraEcode ecode,int num) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name</td>
</tr>
<tr><td><code>ecode</code></td>
<td>Error code</td>
</tr>
<tr><td><code>num</code></td>
<td>The query result</td>
</tr>
</tbody>
</table>



#### The Queried User is in the Channel (onChannelQueryUserIsIn)

This callback function is triggered when a user has queried whether he/she is in the channel.

```
public virtual void onChannelQueryUserIsIn(std::string channelID, std::string account, int isIn){}


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name.</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID defined by the client.</td>
</tr>
<tr><td><code>isIn</code></td>
<td><p>Whether the user is in the channel:</p>

<div><ul>
<li>1: In the channel</li>
<li>0: Not in the channel</li>
</ul>
</div>

</td>
</tr>
</tbody>
</table>



### The Channel Attribute has Changed (onChannelAttrUpdated)

This callback function is triggered when the channel attribute has changed.

```
@property (copy) void(^onChannelAttrUpdated)(NSString* channelID,NSString* name,NSString* value,NSString* type) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name.</td>
</tr>
<tr><td><code>name</code></td>
<td>Attribute name.</td>
</tr>
<tr><td><code>value</code></td>
<td>Attribute value.</td>
</tr>
<tr><td><code>type</code></td>
<td><p>Change types:</p>
<div><ul>
<li>“update”: Update</li>
<li>“del”: Delete</li>
<li>“clear”: Delete all</li>
<li>“set”: N/A</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>



### A Call Request has been Received (onInviteReceived)

This callback function is received by the callee when the callee has received a call invitation or request.

```
@property (copy) void(^onInviteReceived)(NSString* channelID,NSString* account,uint32_t uid, NSString* extra) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name.</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the caller defined by the client.</td>
</tr>
<tr><td><code>uid</code></td>
<td>N/A.</td>
</tr>
<tr><td><code>extra</code></td>
<td><p>Extra information the caller wants to send to the callee.</p>
<p>For example, this is a video call or voice call.</p>
<p>It must be in JSON format.</p>
</td>
</tr>
</tbody>
</table>



### The Callee has Received the Call Request (onInviteReceivedByPeer)

This callback function is received by the caller when the callee has received the call invitation or request.

```
@property (copy) void(^onInviteAcceptedByPeer)(NSString* channelID,NSString* account,uint32_t uid,NSString* extra) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name.</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the callee defined by the client.</td>
</tr>
<tr><td><code>uid</code></td>
<td>N/A.</td>
</tr>
<tr><td><code>extra</code></td>
<td><p>Extra information the caller wants to send to the callee.</p>
<p>For example, this is a video call or voice call.</p>
<p>It must be in JSON format.</p>
</td>
</tr>
</tbody>
</table>



### The Callee has Accepted the Call Request (onInviteAcceptedByPeer)

This callback function is received by the caller when the callee has accepted the call invitation or request.

```
@property (copy) void(^onInviteRefusedByPeer)(NSString* channelID,NSString* account,uint32_t uid,NSString* extra) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the callee defined by the client.</td>
</tr>
<tr><td><code>uid</code></td>
<td>N/A</td>
</tr>
<tr><td><code>extra</code></td>
<td><p>Extra information the caller wants to send to the callee.</p>
<p>For example, this is a video call or voice call.</p>
<p>It must be in JSON format.</p>
</td>
</tr>
</tbody>
</table>



### The Callee has Rejected the Call Request (onInviteRefusedByPeer)

This callback function is received by the caller when the callee rejects the call invitation or request.

```
@property (copy) void(^onInviteRefusedByPeer)(NSString* channelID,NSString* account,uint32_t uid) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name.</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the callee defined by the client.</td>
</tr>
<tr><td><code>uid</code></td>
<td>N/A.</td>
</tr>
</tbody>
</table>



### A Call has Failed (onInviteFailed)

This callback function is triggered when a call has failed.

```
@property (copy) void(^onInviteFailed)(NSString* channelID,NSString* account,uint32_t uid,AgoraEcode ecode,NSString* extra) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name.</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the callee defined by the client.</td>
</tr>
<tr><td><code>uid</code></td>
<td>N/A.</td>
</tr>
<tr><td><code>extra</code></td>
<td><p>Extra information the caller wants to send to the callee.</p>
<p>For example, this is a video call or voice call.</p>
<p>It must be in JSON format.</p>
</td>
</tr>
</tbody>
</table>



### The Callee has Ended the Call (onInviteEndByPeer)

This callback function is triggered when the callee has ended the call.

```
@property (copy) void(^onInviteEndByPeer)(NSString* channelID,NSString* account,uint32_t uid,NSString* extra) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name.</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the callee defined by the client.</td>
</tr>
<tr><td><code>msg</code></td>
<td>Message body.</td>
</tr>
<tr><td><code>extra</code></td>
<td><p>Extra information the caller wants to deliver to the callee.</p>
<p>For example, this is a video call or voice call.</p>
<p>It must be in JSON format.</p>
</td>
</tr>
</tbody>
</table>



### The Caller has Ended the Call (onInviteEndByMyself)

This callback function is triggered when the caller ends the call.

```
@property (copy) void(^onInviteEndByMyself)(NSString* channelID,NSString* account,uint32_t uid) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name.</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the caller defined by the client.</td>
</tr>
<tr><td><code>uid</code></td>
<td>N/A.</td>
</tr>
</tbody>
</table>



#### A DTMF Message sent by the Callee has been Received (onInviteMsg)

This callback function is triggered when the caller has received the DTMF message sent by the callee.

```
@property (copy) void(^onInviteMsg)(NSString* channelID,NSString* account,uint32_t uid,NSString* msgType,NSString* msgData,NSString* extra) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name. It can be up to 128 visible characters.</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the callee defined by the client.</td>
</tr>
<tr><td><code>uid</code></td>
<td>N/A.</td>
</tr>
<tr><td><code>msgType</code></td>
<td>Message type (DTMF).</td>
</tr>
<tr><td><code>msgData</code></td>
<td>Detailed DTMF message. Supported strings include: 0-9, * and #.</td>
</tr>
<tr><td><code>extra</code></td>
<td>Extra information of the call, which can be a string, a JSON string, or NULL.</td>
</tr>
</tbody>
</table>



### The User has Failed to Send a Message (onMessageSendError)

This callback function is triggered when the user has failed to send a message.

```
@property (copy) void(^onMessageSendError)(NSString* messageID,AgoraEcode ecode) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>messageID</code></td>
<td>Message ID</td>
</tr>
<tr><td><code>ecode</code></td>
<td>Error code</td>
</tr>
</tbody>
</table>



### The User has Successfully Sent a Message (onMessageSendSuccess)

This callback function is triggered when the user has successfully sent a message.

```
@property (copy) void(^onMessageSendSuccess)(NSString* messageID) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>messageID</code></td>
<td>Message ID</td>
</tr>
</tbody>
</table>



### A Message has been Received (onMessageInstantReceive)

This callback function notifies a user that a message has been received.

```
@property (copy) void(^onMessageInstantReceive)(NSString* account,uint32_t uid,NSString* msg) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>account</code></td>
<td>User ID defined by the client.</td>
</tr>
<tr><td><code>uid</code></td>
<td>N/A.</td>
</tr>
<tr><td><code>msg</code></td>
<td>Message body.</td>
</tr>
</tbody>
</table>



### A Channel Message has been Received (onMessageChannelReceive)

This callback function is triggered when a channel message has been received.

```
@property (copy) void(^onMessageChannelReceive)(NSString* channelID,NSString* account,uint32_t uid,NSString* msg) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>channelID</code></td>
<td>Channel name</td>
</tr>
<tr><td><code>account</code></td>
<td>User ID defined by the client</td>
</tr>
<tr><td><code>uid</code></td>
<td>N/A</td>
</tr>
<tr><td><code>msg</code></td>
<td>Message body</td>
</tr>
</tbody>
</table>



### A Line has been Created in a Log File (onLog)

This callback function is triggered when a line has been created in a log file.

```
@property (copy) void(^onLog)(NSString* txt) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>txt</code></td>
<td>Line in the log file.</td>
</tr>
</tbody>
</table>



### An Attribute of a Specified User (onUserAttrResult)

This callback function is triggered when the user has queried an attribute of a specified user.

```
@property (copy) void(^onUserAttrResult)(NSString* account,NSString* name,NSString* value) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the specified user defined by the client.</td>
</tr>
<tr><td><code>name</code></td>
<td>Attribute name.</td>
</tr>
<tr><td><code>value</code></td>
<td>Value of the attribute.</td>
</tr>
</tbody>
</table>



### All Attributes of a Specified User (onUserAttrAllResult)

This callback function is triggered when the user has queried all attributes of a specified user.

```
@property (copy) void(^onUserAttrAllResult)(NSString* account, NSString* value) ;


```

<table>
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr><th>Parameter</th>
<th>Description</th>
</tr>
<tr><td><code>account</code></td>
<td>User ID of the specified user defined by the client.</td>
</tr>
<tr><td><code>value</code></td>
<td>JSON values of all attributes of the user.</td>
</tr>
</tbody>
</table>



## Error Codes and Warning Codes

See [Error Codes and Warning Codes](../../en/API%20Reference/the_error_signaling.md).
